"use strict";(self.webpackChunkfenix_app=self.webpackChunkfenix_app||[]).push([[927,984],{8984:(I,x,s)=>{s.d(x,{_:()=>j});var p=s(7574),B=s(8259),l=s.n(B),f=s(7716),m=s(6518),h=s(4655);let j=(()=>{class u{constructor(d,_){this.authService=d,this.router=_,this.transacciones=[]}canActivate(d,_){return this.permisos(d)}CanLoad(d,_){return this.permisos(d)}permisos(d){var _=this.authService.usuario.transacciones;return new p.y(t=>{if(_){let v=_.find(J=>J===d.data.Transaccion);v==d.data.Transaccion?(console.log("acceso a:",v),t.next(!0)):(t.next(!1),console.log("sin acceso"),l().fire({title:"Acceso denegado",html:"No cuentas con el permiso",icon:"error",confirmButtonText:"ok"}))}else t.next(!1),console.log("sin permisos"),l().fire({title:"Acceso denegado",html:"No cuentas con permisos",icon:"error",confirmButtonText:"ok"})})}}return u.\u0275fac=function(d){return new(d||u)(f.LFG(m.e),f.LFG(h.F0))},u.\u0275prov=f.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},1927:(I,x,s)=>{s.r(x),s.d(x,{InventarioModule:()=>wt});var p=s(8583),B=s(206),l=s(3679),f=s(4655),m=s(8984),h=s(8390),j=s(8259),u=s.n(j),C=s(9761),d=s(4395),_=s(8002),t=s(7716),v=s(2340),J=s(1841);let A=(()=>{class e{constructor(i){this.httpClient=i,this.url=`${v.N.baseUrl}/api/inventario_general/`,this.urlU=`${v.N.baseUrl}/api/ubicacion/`,this.urlP=`${v.N.baseUrl}/api/producto_servicio/`,this.urlA=`${v.N.baseUrl}/api/auditoria/`}guardarinventario(i){return this.httpClient.post(this.url,i)}obtenerinventarios(){return this.httpClient.get(this.url)}obtenerinventario(i,o,a,r){return this.httpClient.get(this.url+o+`?ubi=${i}&tipo=${a}&consulta=${r}`)}actualizarinventario(i){return this.httpClient.put(this.url+i._id,i)}eliminarinventario(i){return this.httpClient.delete(this.url+i)}obtenerubicaciones(){return this.httpClient.get(this.urlU)}obtenerubicacion(i){return this.httpClient.get(this.urlU+i)}obtenerproductos(){return this.httpClient.get(this.urlP)}obtenerproducto(i,o){return this.httpClient.get(this.urlP+i+`?tipo=${o}`)}guardarauditoria(i){return this.httpClient.post(this.urlA,i)}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(J.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var b=s(6518),U=s(8382),g=s(3738),N=s(5618),Z=s(8295),q=s(6627),y=s(9983),T=s(5781),w=s(1095),E=s(2458);function Q(e,n){if(1&e&&(t.TgZ(0,"mat-option",17),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.Q6J("value",i),t.xp6(1),t.hij(" ",i," ")}}let Y=(()=>{class e{constructor(i,o,a){this.httpservi=i,this.authService=o,this.servimenu=a,this.filter="",this.myControl=new l.NI(""),this.options=[],this.prod="",this.filterValue="",this.valorI=0,this.ubicacion=[],this.inventario={id_prod_serv:"",id_inventario:"",cantidad:1,costo:0,precio:0,ubicacion:"",tipo:"Producto"}}ngOnInit(){this.servimenu.setencabezado("Alta de inventario"),this.valorubicacion(this.authService.usuario.ubicacion),this.filteredOptions=this.myControl.valueChanges.pipe((0,C.O)(""),(0,d.b)(200),(0,_.U)(i=>this._filter(i||"")))}formato(){this.inventario.id_inventario="I"+String(1e9+this.valorI).slice(1)}guardar(){""!==this.inventario.id_prod_serv?this.httpservi.obtenerinventarios().subscribe(i=>{this.valorI=i+1,this.formato(),this.crearinventario()}):u().fire({title:"Llene los campos",text:"Favor de llenar los campos",icon:"warning",confirmButtonText:"ok"})}crearinventario(){this.httpservi.guardarinventario(this.inventario).subscribe(i=>{console.log("agregado",i),this.modal()},i=>{u().fire({title:"Producto repetido",html:"El producto ya se encuentra en la ubicaci\xf3n seleccionada",icon:"warning",confirmButtonText:"ok"}),console.log(i)})}modal(){u().fire({title:"Agregado",html:`Porducto con numero de inventario  <b>${this.inventario.id_inventario}</b> dado de alta correctamente`,icon:"success",confirmButtonText:"ok"}).then(i=>{i.isConfirmed&&(this.inventario.cantidad=1,this.inventario.costo=0,this.inventario.precio=0,this.prod="",this.myControl.patchValue(""),this.options=[])})}_filter(i){return this.filterValue=i.toLowerCase(),console.log(this.filterValue),this.filterValue?(this.productos(),this.options.filter(o=>o.toLowerCase().includes(this.filterValue))):this.options.filter(o=>o.toLowerCase().includes(this.filterValue))}productos(){this.httpservi.obtenerproducto(this.filterValue,"Producto").subscribe(i=>{this.options=[];for(const o in i)this.options.push(i[o].descripcion)})}idproducto(){this.prod=this.myControl.value,this.httpservi.obtenerproducto(this.prod,"Producto").subscribe(i=>{console.log(i[0].id_prod_serv),this.inventario.id_prod_serv=i[0].id_prod_serv,this.guardar()})}valorubicacion(i){this.httpservi.obtenerubicacion(i).subscribe(a=>{for(const r in a)this.inventario.ubicacion=a[r].id_ubicacion})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(A),t.Y36(b.e),t.Y36(U.h))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-alta"]],decls:50,vars:9,consts:[[1,"custom"],[1,"container"],[1,"row"],["fxLayoutAlign","space-between",1,"col-sm-auto"],["appearance","fill"],["matInput","","placeholder","0","readonly","",3,"value"],["appearance","fill",1,"example-full-width",2,"width","250px"],["type","text","placeholder","","aria-label","Nombre","matInput","",3,"formControl","matAutocomplete"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-auto"],["appearance","fill",2,"width","110px"],["matInput","","placeholder","0","value","1",3,"ngModel","ngModelChange"],["matInput","","placeholder","","value","",3,"ngModel","ngModelChange"],[1,"col-sm"],[1,"example-button-row"],["mat-raised-button","","color","accent",2,"margin-top","15px",3,"click"],[3,"value"]],template:function(i,o){if(1&i&&(t._UZ(0,"br"),t.TgZ(1,"mat-card",0),t.TgZ(2,"h3"),t._uU(3,"Ingrese los datos"),t.qZA(),t.TgZ(4,"mat-card-content"),t.TgZ(5,"div",1),t.TgZ(6,"div",2),t.TgZ(7,"div",3),t.TgZ(8,"mat-form-field",4),t.TgZ(9,"mat-label"),t._uU(10,"Tu ubicaci\xf3n "),t.TgZ(11,"mat-icon"),t._uU(12,"locked"),t.qZA(),t.qZA(),t._UZ(13,"input",5),t.qZA(),t.qZA(),t.TgZ(14,"div",3),t.TgZ(15,"mat-form-field",6),t.TgZ(16,"mat-label"),t._uU(17,"Nombre del producto"),t.qZA(),t._UZ(18,"input",7),t.TgZ(19,"mat-autocomplete",null,8),t.YNc(21,Q,2,2,"mat-option",9),t.ALo(22,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"div",10),t.TgZ(24,"mat-form-field",11),t.TgZ(25,"mat-label"),t._uU(26,"Cantidad "),t.TgZ(27,"mat-icon"),t._uU(28,"create"),t.qZA(),t.qZA(),t.TgZ(29,"input",12),t.NdJ("ngModelChange",function(r){return o.inventario.cantidad=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(30,"div",10),t.TgZ(31,"mat-form-field",11),t.TgZ(32,"mat-label"),t._uU(33,"Costo "),t.TgZ(34,"mat-icon"),t._uU(35,"create"),t.qZA(),t.qZA(),t.TgZ(36,"input",13),t.NdJ("ngModelChange",function(r){return o.inventario.costo=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(37,"div",10),t.TgZ(38,"mat-form-field",11),t.TgZ(39,"mat-label"),t._uU(40,"Precio "),t.TgZ(41,"mat-icon"),t._uU(42,"create"),t.qZA(),t.qZA(),t.TgZ(43,"input",13),t.NdJ("ngModelChange",function(r){return o.inventario.precio=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(44,"div",14),t.TgZ(45,"div",15),t.TgZ(46,"button",16),t.NdJ("click",function(){return o.idproducto()}),t._uU(47,"Guardar"),t.TgZ(48,"mat-icon"),t._uU(49,"check"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&i){const a=t.MAs(20);t.xp6(13),t.Q6J("value",o.authService.usuario.ubicacion),t.xp6(5),t.Q6J("formControl",o.myControl)("matAutocomplete",a),t.xp6(3),t.Q6J("ngForOf",t.lcZ(22,7,o.filteredOptions)),t.xp6(8),t.Q6J("ngModel",o.inventario.cantidad),t.xp6(7),t.Q6J("ngModel",o.inventario.costo),t.xp6(7),t.Q6J("ngModel",o.inventario.precio)}},directives:[g.a8,g.dn,N.Wh,Z.KE,Z.hX,q.Hw,y.Nt,l.Fj,T.ZL,l.JJ,l.oH,T.XC,p.sg,l.On,w.lW,E.ey],pipes:[p.Ov],styles:[""]}),e})();var c=s(2789),M=s(9692);function O(e,n){if(1&e&&(t.TgZ(0,"mat-option",10),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.Q6J("value",i),t.xp6(1),t.hij(" ",i," ")}}let z=(()=>{class e{constructor(i,o){this.httpservi=i,this.authService=o,this.filter="",this.myControl=new l.NI(""),this.options=[],this.prod="",this.filterValue="",this.id_ubicacion="",this.messageEvent=new t.vpe}ngOnInit(){this.ubicacionusuario(this.authService.usuario.ubicacion),this.filteredOptions=this.myControl.valueChanges.pipe((0,C.O)(""),(0,d.b)(100),(0,_.U)(i=>this._filter(i||"")))}_filter(i){return this.filterValue=i.toLowerCase(),this.filterValue?(this.inventarios(),this.options.filter(o=>o.toLowerCase().includes(this.filterValue))):this.options.filter(o=>o.toLowerCase().includes(this.filterValue))}inventarios(){this.httpservi.obtenerinventario(this.id_ubicacion,this.filterValue,"Producto","").subscribe(i=>{this.options=[];for(const o in i)this.options.push(i[o].productos_servicios.descripcion),this.options.push(i[o].productos_servicios.codigo_barra),console.log(this.options)})}ubicacionusuario(i){this.httpservi.obtenerubicacion(i).subscribe(a=>{for(const r in a)this.id_ubicacion=a[r].id_ubicacion;this.prod="",this.options=[]})}inventarioseleccionado(){this.prod=this.myControl.value,this.options=[],this.messageEvent.emit(this.prod),this.myControl.patchValue("")}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(A),t.Y36(b.e))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-buscador"]],outputs:{messageEvent:"messageEvent"},decls:20,vars:5,consts:[[1,"custom"],[1,"row"],["fxLayoutAlign","space-between",1,"col-sm-auto"],["appearance","fill",1,"example-full-width",2,"width","250px"],["type","text","placeholder","","aria-label","Nombre","matInput","",3,"formControl","matAutocomplete"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm"],[1,"example-button-row",2,"margin-right","1px"],["mat-raised-button","","color","accent",2,"margin-top","15px",3,"click"],[3,"value"]],template:function(i,o){if(1&i&&(t._UZ(0,"br"),t.TgZ(1,"mat-card",0),t.TgZ(2,"mat-card-content"),t.TgZ(3,"div",1),t.TgZ(4,"div",2),t.TgZ(5,"mat-form-field",3),t.TgZ(6,"mat-label"),t._uU(7,"Nombre del producto"),t.qZA(),t._UZ(8,"input",4),t.TgZ(9,"mat-autocomplete",null,5),t.YNc(11,O,2,2,"mat-option",6),t.ALo(12,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",7),t.TgZ(14,"div",8),t.TgZ(15,"button",9),t.NdJ("click",function(){return o.inventarioseleccionado()}),t._uU(16,"Buscar "),t.TgZ(17,"mat-icon"),t._uU(18,"search"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t._UZ(19,"br")),2&i){const a=t.MAs(10);t.xp6(8),t.Q6J("formControl",o.myControl)("matAutocomplete",a),t.xp6(3),t.Q6J("ngForOf",t.lcZ(12,3,o.filteredOptions))}},directives:[g.a8,g.dn,N.Wh,Z.KE,Z.hX,y.Nt,l.Fj,T.ZL,l.JJ,l.oH,T.XC,p.sg,w.lW,q.Hw,E.ey],pipes:[p.Ov],styles:[""]}),e})();function S(e,n){1&e&&(t.TgZ(0,"th",19),t._uU(1," # "),t.qZA())}function F(e,n){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const i=n.index;t.xp6(1),t.hij(" ",i+1," ")}}function L(e,n){1&e&&(t.TgZ(0,"th",21),t._uU(1," N\xfamero de servicio"),t.qZA())}function P(e,n){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.id_inventario," ")}}function k(e,n){1&e&&(t.TgZ(0,"th",21),t._uU(1," Descripci\xf3n"),t.qZA())}function R(e,n){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,i.productos_servicios.descripcion)," ")}}function V(e,n){1&e&&(t.TgZ(0,"th",19),t._uU(1," Costo"),t.qZA())}function $(e,n){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.costo," ")}}function H(e,n){1&e&&(t.TgZ(0,"th",19),t._uU(1," Precio"),t.qZA())}function W(e,n){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.precio," ")}}function G(e,n){1&e&&(t.TgZ(0,"th",19),t._uU(1," Existencias"),t.qZA())}function X(e,n){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.cantidad," ")}}function K(e,n){1&e&&(t.TgZ(0,"th",21),t._uU(1," Ubicaci\xf3n"),t.qZA())}function tt(e,n){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,i.ubicacion.descripcion)," ")}}function it(e,n){1&e&&t._UZ(0,"th",22)}function et(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"td",20),t.TgZ(1,"a",23),t.NdJ("click",function(){const r=t.CHM(i).$implicit;return t.oxw().eliminar(r._id,r.productos_servicios.descripcion)}),t.TgZ(2,"mat-icon",24),t._uU(3,"delete"),t.qZA(),t.qZA(),t.qZA()}}function ot(e,n){1&e&&t._UZ(0,"tr",25)}function nt(e,n){1&e&&t._UZ(0,"tr",26)}const at=function(){return[5,10,20]};let rt=(()=>{class e{constructor(i,o,a){this.httpservi=i,this.authService=o,this.servimenu=a,this.prod="",this.productostabla=[],this.id_ubicacion="",this.displayedColumns=["index","id_inventario","productos_servicios.descripcion","costo","precio","cantidad","ubicacion.descripcion","borrar"],this.dataSource=new c.by}ngOnInit(){this.servimenu.setencabezado("Baja de inventario"),this.ubicacionusuario(this.authService.usuario.ubicacion)}inventarioseleccionado(i){this.prod=i,""!==this.prod&&this.httpservi.obtenerinventario(this.id_ubicacion,this.prod,"Producto","").subscribe(o=>{this.productostabla=[],this.productostabla=o,this.dataSource=new c.by(this.productostabla),this.dataSource.paginator=this.paginator,this.dataSource.paginator._intl.itemsPerPageLabel="Filas por pagina",this.prod=""})}ubicacionusuario(i){this.httpservi.obtenerubicacion(i).subscribe(a=>{for(const r in a)this.id_ubicacion=a[r].id_ubicacion;this.prod=""})}eliminar(i,o){u().fire({title:"\xbfEstas seguro?",html:`Estas por dar de baja el producto <b>${o}</b>`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, dar de baja!"}).then(a=>{a.isConfirmed&&this.httpservi.eliminarinventario(i).subscribe(r=>{console.log("eliminado",r),u().fire("Proceso correcto!","El producto fue dado de baja correctamente.","success").then(D=>{D.isConfirmed&&(this.productostabla=[],this.dataSource=new c.by)})},r=>{u().fire({title:"Operaci\xf3n invalida",html:"Inventario cuenta con existencias",icon:"warning",confirmButtonText:"ok"}),console.log(r)})})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(A),t.Y36(b.e),t.Y36(U.h))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-baja"]],viewQuery:function(i,o){if(1&i&&t.Gf(M.NW,5),2&i){let a;t.iGM(a=t.CRH())&&(o.paginator=a.first)}},decls:34,vars:5,consts:[[3,"messageEvent"],[1,"row"],[1,"container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","","width","10%",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id_inventario"],["mat-header-cell","","width","20%",4,"matHeaderCellDef"],["matColumnDef","productos_servicios.descripcion"],["matColumnDef","costo"],["matColumnDef","precio"],["matColumnDef","cantidad"],["matColumnDef","ubicacion.descripcion"],["matColumnDef","borrar"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","label","seleccione",3,"pageSizeOptions"],["mat-header-cell","","width","10%"],["mat-cell",""],["mat-header-cell","","width","20%"],["mat-header-cell",""],["type","button",3,"click"],["color","warn",1,"icon"],["mat-header-row",""],["mat-row",""]],template:function(i,o){1&i&&(t.TgZ(0,"app-buscador",0),t.NdJ("messageEvent",function(r){return o.inventarioseleccionado(r)}),t.qZA(),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"mat-card"),t.TgZ(4,"h3"),t._uU(5,"Detalles"),t.qZA(),t.TgZ(6,"table",3),t.ynx(7,4),t.YNc(8,S,2,0,"th",5),t.YNc(9,F,2,1,"td",6),t.BQk(),t.ynx(10,7),t.YNc(11,L,2,0,"th",8),t.YNc(12,P,2,1,"td",6),t.BQk(),t.ynx(13,9),t.YNc(14,k,2,0,"th",8),t.YNc(15,R,3,3,"td",6),t.BQk(),t.ynx(16,10),t.YNc(17,V,2,0,"th",5),t.YNc(18,$,2,1,"td",6),t.BQk(),t.ynx(19,11),t.YNc(20,H,2,0,"th",5),t.YNc(21,W,2,1,"td",6),t.BQk(),t.ynx(22,12),t.YNc(23,G,2,0,"th",5),t.YNc(24,X,2,1,"td",6),t.BQk(),t.ynx(25,13),t.YNc(26,K,2,0,"th",8),t.YNc(27,tt,3,3,"td",6),t.BQk(),t.ynx(28,14),t.YNc(29,it,1,0,"th",15),t.YNc(30,et,4,0,"td",6),t.BQk(),t.YNc(31,ot,1,0,"tr",16),t.YNc(32,nt,1,0,"tr",17),t.qZA(),t._UZ(33,"mat-paginator",18),t.qZA(),t.qZA(),t.qZA()),2&i&&(t.xp6(6),t.Q6J("dataSource",o.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(4,at)))},directives:[z,g.a8,c.BZ,c.w1,c.fO,c.Dz,c.as,c.nj,M.NW,c.ge,c.ev,q.Hw,c.XQ,c.Gk],pipes:[p.rS],styles:["table[_ngcontent-%COMP%]{width:100%;display:block;overflow-x:auto}"]}),e})();function st(e,n){if(1&e&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.Q6J("value",i),t.xp6(1),t.hij(" ",i," ")}}function ct(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1," # "),t.qZA())}function lt(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const i=n.index;t.xp6(1),t.hij(" ",i+1," ")}}function ut(e,n){1&e&&(t.TgZ(0,"th",29),t._uU(1," N\xfamero de servicio"),t.qZA())}function dt(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.id_inventario," ")}}function pt(e,n){1&e&&(t.TgZ(0,"th",29),t._uU(1," Descripci\xf3n"),t.qZA())}function mt(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,i.productos_servicios.descripcion)," ")}}function ht(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1," Costo"),t.qZA())}function _t(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.costo," ")}}function gt(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1," Precio"),t.qZA())}function Zt(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.precio," ")}}function vt(e,n){1&e&&(t.TgZ(0,"th",30),t._uU(1," Existencias"),t.qZA())}function ft(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.cantidad," ")}}function Tt(e,n){1&e&&(t.TgZ(0,"th",29),t._uU(1," Ubicaci\xf3n"),t.qZA())}function Ct(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,i.ubicacion.descripcion)," ")}}function At(e,n){1&e&&t._UZ(0,"tr",31)}function bt(e,n){1&e&&t._UZ(0,"tr",32)}const qt=function(){return[5,10,20]};let xt=(()=>{class e{constructor(i,o,a){this.httpservi=i,this.authService=o,this.servimenu=a,this.filter="",this.myControl=new l.NI(""),this.options=[],this.prod="",this.filterValue="",this.productostabla=[],this.id_ubicacion="",this.displayedColumns=["index","id_inventario","productos_servicios.descripcion","costo","precio","cantidad","ubicacion.descripcion"],this.dataSource=new c.by}ngOnInit(){this.servimenu.setencabezado("Consulta de inventario"),this.ubicacionusuario(this.authService.usuario.ubicacion),this.filteredOptions=this.myControl.valueChanges.pipe((0,C.O)(""),(0,d.b)(100),(0,_.U)(i=>this._filter(i||"")))}_filter(i){return this.filterValue=i.toLowerCase(),this.filterValue?(this.inventarios(),this.options.filter(o=>o.toLowerCase().includes(this.filterValue))):this.options.filter(o=>o.toLowerCase().includes(this.filterValue))}inventarios(){this.httpservi.obtenerinventario(this.id_ubicacion,this.filterValue,"Producto","consulta").subscribe(i=>{this.options=[];for(const o in i)this.options.push(i[o].productos_servicios.descripcion),this.options.push(i[o].productos_servicios.codigo_barra),this.options=[...new Set(this.options)],console.log(this.options)})}ubicacionusuario(i){this.httpservi.obtenerubicacion(i).subscribe(a=>{for(const r in a)this.id_ubicacion=a[r].id_ubicacion;this.prod="",this.options=[]})}inventarioseleccionado(){this.options=[],this.prod=this.myControl.value,""!==this.prod&&this.httpservi.obtenerinventario(this.id_ubicacion,this.prod,"Producto").subscribe(i=>{this.productostabla=[],this.productostabla=i,this.dataSource=new c.by(this.productostabla),this.dataSource.paginator=this.paginator,this.dataSource.paginator._intl.itemsPerPageLabel="Filas por pagina",this.prod="",this.myControl.patchValue("")})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(A),t.Y36(b.e),t.Y36(U.h))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-consulta"]],viewQuery:function(i,o){if(1&i&&t.Gf(M.NW,5),2&i){let a;t.iGM(a=t.CRH())&&(o.paginator=a.first)}},decls:50,vars:10,consts:[[1,"custom"],[1,"row"],["fxLayoutAlign","space-between",1,"col-sm-auto"],["appearance","fill",1,"example-full-width",2,"width","250px"],["type","text","placeholder","","aria-label","Nombre","matInput","",3,"formControl","matAutocomplete"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm"],[1,"example-button-row",2,"margin-right","1px"],["mat-raised-button","","color","accent",2,"margin-top","15px",3,"click"],[1,"container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","","width","10%",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id_inventario"],["mat-header-cell","","width","20%",4,"matHeaderCellDef"],["matColumnDef","productos_servicios.descripcion"],["matColumnDef","costo"],["matColumnDef","precio"],["matColumnDef","cantidad"],["mat-header-cell","","width","14%",4,"matHeaderCellDef"],["matColumnDef","ubicacion.descripcion"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","label","seleccione",3,"pageSizeOptions"],[3,"value"],["mat-header-cell","","width","10%"],["mat-cell",""],["mat-header-cell","","width","20%"],["mat-header-cell","","width","14%"],["mat-header-row",""],["mat-row",""]],template:function(i,o){if(1&i&&(t._UZ(0,"br"),t.TgZ(1,"mat-card",0),t.TgZ(2,"mat-card-content"),t.TgZ(3,"div",1),t.TgZ(4,"div",2),t.TgZ(5,"mat-form-field",3),t.TgZ(6,"mat-label"),t._uU(7,"Nombre del producto"),t.qZA(),t._UZ(8,"input",4),t.TgZ(9,"mat-autocomplete",null,5),t.YNc(11,st,2,2,"mat-option",6),t.ALo(12,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",7),t.TgZ(14,"div",8),t.TgZ(15,"button",9),t.NdJ("click",function(){return o.inventarioseleccionado()}),t._uU(16,"Buscar "),t.TgZ(17,"mat-icon"),t._uU(18,"search"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t._UZ(19,"br"),t.TgZ(20,"div",1),t.TgZ(21,"div",10),t.TgZ(22,"mat-card"),t.TgZ(23,"h3"),t._uU(24,"Detalles"),t.qZA(),t.TgZ(25,"table",11),t.ynx(26,12),t.YNc(27,ct,2,0,"th",13),t.YNc(28,lt,2,1,"td",14),t.BQk(),t.ynx(29,15),t.YNc(30,ut,2,0,"th",16),t.YNc(31,dt,2,1,"td",14),t.BQk(),t.ynx(32,17),t.YNc(33,pt,2,0,"th",16),t.YNc(34,mt,3,3,"td",14),t.BQk(),t.ynx(35,18),t.YNc(36,ht,2,0,"th",13),t.YNc(37,_t,2,1,"td",14),t.BQk(),t.ynx(38,19),t.YNc(39,gt,2,0,"th",13),t.YNc(40,Zt,2,1,"td",14),t.BQk(),t.ynx(41,20),t.YNc(42,vt,2,0,"th",21),t.YNc(43,ft,2,1,"td",14),t.BQk(),t.ynx(44,22),t.YNc(45,Tt,2,0,"th",16),t.YNc(46,Ct,3,3,"td",14),t.BQk(),t.YNc(47,At,1,0,"tr",23),t.YNc(48,bt,1,0,"tr",24),t.qZA(),t._UZ(49,"mat-paginator",25),t.qZA(),t.qZA(),t.qZA()),2&i){const a=t.MAs(10);t.xp6(8),t.Q6J("formControl",o.myControl)("matAutocomplete",a),t.xp6(3),t.Q6J("ngForOf",t.lcZ(12,7,o.filteredOptions)),t.xp6(14),t.Q6J("dataSource",o.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(9,qt))}},directives:[g.a8,g.dn,N.Wh,Z.KE,Z.hX,y.Nt,l.Fj,T.ZL,l.JJ,l.oH,T.XC,p.sg,w.lW,q.Hw,c.BZ,c.w1,c.fO,c.Dz,c.as,c.nj,M.NW,E.ey,c.ge,c.ev,c.XQ,c.Gk],pipes:[p.Ov,p.rS],styles:["table[_ngcontent-%COMP%]{width:100%;display:block;overflow-x:auto}"]}),e})();const Nt=[{path:"",children:[{path:"alta",component:Y,data:{Transaccion:"INVENTARIO-ALTA"},canActivate:[h.z,m._],canLoad:[h.z,m._]},{path:"ajuste",component:(()=>{class e{constructor(i,o,a){this.httpservi=i,this.authService=o,this.servimenu=a,this.prod="",this.bandera=1,this.descripcion="",this.producto="",this.razon_precio="",this.razon_costo="",this.razon_existencia="",this.precio=0,this.costo=0,this.existencia=0,this.nuevo_precio=0,this.nuevo_costo=0,this.nueva_existencia=0,this.inventario={_id:"",id_inventario:"",id_prod_serv:"",cantidad:0,costo:0,precio:0,ubicacion:"",tipo:"Producto"},this.auditoria={id_inventario:"",fecha:new Date,id_usuario:this.authService.usuario._id,usuario:this.authService.usuario.nombre,razon:"",tipo_ajuste:"",valor_anterior:0,nuevo_valor:0}}ngOnInit(){this.servimenu.setencabezado("Ajuste de inventario"),this.ubicacionusuario(this.authService.usuario.ubicacion)}inventarioseleccionado(i){this.prod=i,""!==this.prod&&(this.httpservi.obtenerinventario(this.inventario.ubicacion,this.prod,"Producto","").subscribe(o=>{console.log(o);for(const a in o)this.inventario._id=o[a]._id,this.producto=o[a].productos_servicios.descripcion,this.inventario.id_prod_serv=o[a].id_prod_serv,this.inventario.id_inventario=o[a].id_inventario,this.costo=o[a].costo,this.precio=o[a].precio,this.existencia=o[a].cantidad,this.descripcion=o[a].ubicacion.descripcion,this.auditoria.id_inventario=o[a].id_inventario}),this.bandera=0)}actualizar(){""!==this.auditoria.razon?this.httpservi.actualizarinventario(this.inventario).subscribe(i=>{console.log("actualizado",i),this.modal(),this.httpservi.guardarauditoria(this.auditoria).subscribe(o=>{console.log("auditoria guardada",o)},o=>{u().fire({title:"Ups!!",text:"No se pudo guardar la auditoria",icon:"success",confirmButtonText:"ok"}),console.log(o)})},i=>{u().fire({title:"Ups!!",text:"No se pudieron guardar los cambios",icon:"success",confirmButtonText:"ok"}),console.log(i)}):u().fire({title:"Ups!!",text:"Agregue la raz\xf3n del ajuste",icon:"warning",confirmButtonText:"ok"})}modal(){u().fire({title:"Cambios aplicados",text:"Se han guardado y aplicado los cambios correctamente",icon:"success",confirmButtonText:"ok"}).then(i=>{i.isConfirmed&&(this.razon_precio="",this.razon_costo="",this.razon_existencia="",this.nuevo_precio=0,this.nuevo_costo=0,this.nueva_existencia=0,this.inventarioseleccionado(this.prod))})}ubicacionusuario(i){this.httpservi.obtenerubicacion(i).subscribe(a=>{for(const r in a)this.inventario.ubicacion=a[r].id_ubicacion;this.prod=""})}ajustexistencias(){this.inventario.precio=this.precio,this.inventario.costo=this.costo,this.inventario.cantidad=this.nueva_existencia,this.auditoria.tipo_ajuste="Existencias de Inventario",this.auditoria.valor_anterior=this.existencia,this.auditoria.nuevo_valor=this.inventario.cantidad,this.auditoria.razon=this.razon_existencia,console.log("inventario",this.inventario),console.log("auditoria",this.auditoria),this.actualizar()}ajusteprecio(){this.inventario.precio=this.nuevo_precio,this.inventario.costo=this.costo,this.inventario.cantidad=this.existencia,this.auditoria.tipo_ajuste="Precio de Inventario",this.auditoria.valor_anterior=this.precio,this.auditoria.nuevo_valor=this.inventario.precio,this.auditoria.razon=this.razon_precio,console.log("inventario",this.inventario),console.log("auditoria",this.auditoria),0!==this.nuevo_precio?this.actualizar():u().fire({title:"Ups!!",text:"Agregue el nuevo precio del ajuste",icon:"warning",confirmButtonText:"ok"})}ajustecosto(){this.inventario.precio=this.precio,this.inventario.costo=this.nuevo_costo,this.inventario.cantidad=this.existencia,this.auditoria.tipo_ajuste="Costo de Inventario",this.auditoria.valor_anterior=this.costo,this.auditoria.nuevo_valor=this.inventario.costo,this.auditoria.razon=this.razon_costo,console.log("inventario",this.inventario),console.log("auditoria",this.auditoria),0!==this.nuevo_costo?this.actualizar():u().fire({title:"Ups!!",text:"Agregue el nuevo costo del ajuste",icon:"warning",confirmButtonText:"ok"})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(A),t.Y36(b.e),t.Y36(U.h))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-editar"]],decls:106,vars:12,consts:[[3,"messageEvent"],[1,"row"],[1,"example-container"],["fxLayoutAlign","space-between",1,"col-sm-auto"],["appearance","fill"],["matInput","","placeholder","0","readonly","",3,"value"],["matInput","","placeholder","","value","","readonly","",3,"ngModel","ngModelChange"],["appearance","fill",2,"width","250px"],["matInput","","placeholder","producto","value","","readonly","",3,"ngModel","ngModelChange"],["appearance","fill",2,"width","150px"],["matInput","","placeholder","0","value","","readonly","",3,"ngModel","ngModelChange"],["matInput","","type","number","placeholder","","value","",3,"ngModel","ngModelChange"],["appearance","fill",2,"width","300px"],["matInput","",3,"ngModel","ngModelChange"],[1,"col-sm"],[1,"example-button-row",2,"margin-right","1px"],["mat-raised-button","","color","warn",2,"margin-top","30px",3,"click"],[1,"col-sm-auto"],["mat-raised-button","","color","primary",2,"margin-top","30px",3,"click"],["mat-raised-button","","color","basic",2,"margin-top","30px",3,"click"]],template:function(i,o){1&i&&(t.TgZ(0,"app-buscador",0),t.NdJ("messageEvent",function(r){return o.inventarioseleccionado(r)}),t.qZA(),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"mat-card"),t.TgZ(4,"h3"),t._uU(5,"Detalles del producto"),t.qZA(),t.TgZ(6,"mat-card-content"),t.TgZ(7,"div",1),t.TgZ(8,"div",3),t.TgZ(9,"mat-form-field",4),t.TgZ(10,"mat-label"),t._uU(11,"Ubicaci\xf3n"),t.TgZ(12,"mat-icon"),t._uU(13,"locked"),t.qZA(),t.qZA(),t._UZ(14,"input",5),t.qZA(),t.qZA(),t.TgZ(15,"div",3),t.TgZ(16,"mat-form-field",4),t.TgZ(17,"mat-label"),t._uU(18,"N\xfamero de inventario "),t.TgZ(19,"mat-icon"),t._uU(20,"locked"),t.qZA(),t.qZA(),t.TgZ(21,"input",6),t.NdJ("ngModelChange",function(r){return o.inventario.id_inventario=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(22,"div",3),t.TgZ(23,"mat-form-field",7),t.TgZ(24,"mat-label"),t._uU(25,"Descripci\xf3n del producto "),t.TgZ(26,"mat-icon"),t._uU(27,"locked"),t.qZA(),t.qZA(),t.TgZ(28,"input",8),t.NdJ("ngModelChange",function(r){return o.producto=r}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(29,"mat-card-content"),t.TgZ(30,"div",1),t.TgZ(31,"div",3),t.TgZ(32,"mat-form-field",9),t.TgZ(33,"mat-label"),t._uU(34,"Precio "),t.TgZ(35,"mat-icon"),t._uU(36,"locked"),t.qZA(),t.qZA(),t.TgZ(37,"input",10),t.NdJ("ngModelChange",function(r){return o.precio=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(38,"div",3),t.TgZ(39,"mat-form-field",4),t.TgZ(40,"mat-label"),t._uU(41,"Nuevo precio "),t.TgZ(42,"mat-icon"),t._uU(43,"create"),t.qZA(),t.qZA(),t.TgZ(44,"input",11),t.NdJ("ngModelChange",function(r){return o.nuevo_precio=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(45,"div",3),t.TgZ(46,"mat-form-field",12),t.TgZ(47,"mat-label"),t._uU(48,"Raz\xf3n del ajuste"),t.qZA(),t.TgZ(49,"textarea",13),t.NdJ("ngModelChange",function(r){return o.razon_precio=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(50,"div",14),t.TgZ(51,"div",15),t.TgZ(52,"button",16),t.NdJ("click",function(){return o.ajusteprecio()}),t._uU(53,"Guardar precio"),t.TgZ(54,"mat-icon"),t._uU(55,"build"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(56,"div",1),t.TgZ(57,"div",3),t.TgZ(58,"mat-form-field",9),t.TgZ(59,"mat-label"),t._uU(60,"Costo "),t.TgZ(61,"mat-icon"),t._uU(62,"locked"),t.qZA(),t.qZA(),t.TgZ(63,"input",10),t.NdJ("ngModelChange",function(r){return o.costo=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(64,"div",3),t.TgZ(65,"mat-form-field",4),t.TgZ(66,"mat-label"),t._uU(67,"Nuevo costo "),t.TgZ(68,"mat-icon"),t._uU(69,"create"),t.qZA(),t.qZA(),t.TgZ(70,"input",11),t.NdJ("ngModelChange",function(r){return o.nuevo_costo=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(71,"div",17),t.TgZ(72,"mat-form-field",12),t.TgZ(73,"mat-label"),t._uU(74,"Raz\xf3n del ajuste"),t.qZA(),t.TgZ(75,"textarea",13),t.NdJ("ngModelChange",function(r){return o.razon_costo=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(76,"div",14),t.TgZ(77,"button",18),t.NdJ("click",function(){return o.ajustecosto()}),t._uU(78,"Guardar costo"),t.TgZ(79,"mat-icon"),t._uU(80,"build"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(81,"div",1),t.TgZ(82,"div",3),t.TgZ(83,"mat-form-field",9),t.TgZ(84,"mat-label"),t._uU(85,"Cantidad/existencias "),t.TgZ(86,"mat-icon"),t._uU(87,"locked"),t.qZA(),t.qZA(),t._UZ(88,"input",5),t.qZA(),t.qZA(),t.TgZ(89,"div",3),t.TgZ(90,"mat-form-field",4),t.TgZ(91,"mat-label"),t._uU(92,"Nueva cantidad/existencias "),t.TgZ(93,"mat-icon"),t._uU(94,"create"),t.qZA(),t.qZA(),t.TgZ(95,"input",11),t.NdJ("ngModelChange",function(r){return o.nueva_existencia=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(96,"div",17),t.TgZ(97,"mat-form-field",12),t.TgZ(98,"mat-label"),t._uU(99,"Raz\xf3n del ajuste"),t.qZA(),t.TgZ(100,"textarea",13),t.NdJ("ngModelChange",function(r){return o.razon_existencia=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(101,"div",14),t.TgZ(102,"button",19),t.NdJ("click",function(){return o.ajustexistencias()}),t._uU(103,"Guardar existencias"),t.TgZ(104,"mat-icon"),t._uU(105,"build"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&i&&(t.xp6(14),t.Q6J("value",o.descripcion),t.xp6(7),t.Q6J("ngModel",o.inventario.id_inventario),t.xp6(7),t.Q6J("ngModel",o.producto),t.xp6(9),t.Q6J("ngModel",o.precio),t.xp6(7),t.Q6J("ngModel",o.nuevo_precio),t.xp6(5),t.Q6J("ngModel",o.razon_precio),t.xp6(14),t.Q6J("ngModel",o.costo),t.xp6(7),t.Q6J("ngModel",o.nuevo_costo),t.xp6(5),t.Q6J("ngModel",o.razon_costo),t.xp6(13),t.Q6J("value",o.existencia),t.xp6(7),t.Q6J("ngModel",o.nueva_existencia),t.xp6(5),t.Q6J("ngModel",o.razon_existencia))},directives:[z,g.a8,g.dn,N.Wh,Z.KE,Z.hX,q.Hw,y.Nt,l.Fj,l.JJ,l.On,l.wV,w.lW],styles:[""]}),e})(),data:{Transaccion:"INVENTARIO-AJUSTE"},canActivate:[h.z,m._],canLoad:[h.z,m._]},{path:"baja",component:rt,data:{Transaccion:"INVENTARIO-BAJA"},canActivate:[h.z,m._],canLoad:[h.z,m._]},{path:"consulta",component:xt,data:{Transaccion:"INVENTARIO-CONSULTA"},canActivate:[h.z,m._],canLoad:[h.z,m._]},{path:"**",redirectTo:"/menu/md"}]}];let yt=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[f.Bz.forChild(Nt)],f.Bz]}),e})(),wt=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[p.ez,B.q,l.u5,l.UX,yt]]}),e})()}}]);