"use strict";(self.webpackChunkfenix_app=self.webpackChunkfenix_app||[]).push([[853],{8984:(I,x,s)=>{s.d(x,{_:()=>T});var d=s(7574),M=s(8259),l=s.n(M),Z=s(7716),m=s(6518),h=s(4655);let T=(()=>{class v{constructor(p,u){this.authService=p,this.router=u,this.transacciones=[]}canActivate(p,u){return this.permisos(p)}CanLoad(p,u){return this.permisos(p)}permisos(p){var u=this.authService.usuario.transacciones;return new d.y(t=>{if(u){let f=u.find(j=>j===p.data.Transaccion);f==p.data.Transaccion?(console.log("acceso a:",f),t.next(!0)):(t.next(!1),console.log("sin acceso"),l().fire({title:"Acceso denegado",html:"No cuentas con el permiso",icon:"error",confirmButtonText:"ok"}))}else t.next(!1),console.log("sin permisos"),l().fire({title:"Acceso denegado",html:"No cuentas con permisos",icon:"error",confirmButtonText:"ok"})})}}return v.\u0275fac=function(p){return new(p||v)(Z.LFG(m.e),Z.LFG(h.F0))},v.\u0275prov=Z.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},5853:(I,x,s)=>{s.r(x),s.d(x,{InventarioServiciosModule:()=>Ut});var d=s(8583),M=s(206),l=s(3679),Z=s(4655),m=s(8984),h=s(8390),T=s(9761),v=s(4395),A=s(8002),p=s(8259),u=s.n(p),t=s(7716),f=s(2340),j=s(1841);let b=(()=>{class e{constructor(i){this.httpClient=i,this.url=`${f.N.baseUrl}/api/inventario_general/`,this.urlU=`${f.N.baseUrl}/api/ubicacion/`,this.urlS=`${f.N.baseUrl}/api/producto_servicio/`,this.urlA=`${f.N.baseUrl}/api/auditoria/`}guardarinventario(i){return this.httpClient.post(this.url,i)}obtenerinventarios(){return this.httpClient.get(this.url)}obtenerinventario(i,o,a,r){return this.httpClient.get(this.url+o+`?ubi=${i}&tipo=${a}&consulta=${r}`)}actualizarinventario(i){return this.httpClient.put(this.url+i._id,i)}eliminarinventario(i){return this.httpClient.delete(this.url+i)}obtenerubicaciones(){return this.httpClient.get(this.urlU)}obtenerubicacion(i){return this.httpClient.get(this.urlU+i)}obtenerservicios(){return this.httpClient.get(this.urlS)}obtenerservicio(i,o){return this.httpClient.get(this.urlS+i+`?tipo=${o}`)}guardarauditoria(i){return this.httpClient.post(this.urlA,i)}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(j.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var q=s(6518),y=s(8382),_=s(3738),w=s(5618),g=s(8295),U=s(6627),N=s(9983),C=s(5781),S=s(1095),J=s(2458);function O(e,n){if(1&e&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.Q6J("value",i),t.xp6(1),t.hij(" ",i," ")}}let Y=(()=>{class e{constructor(i,o,a){this.httpservi=i,this.authService=o,this.servimenu=a,this.filter="",this.myControl=new l.NI(""),this.options=[],this.servi="",this.filterValue="",this.valorI=0,this.ubicacion=[],this.inventario={id_prod_serv:"",id_inventario:"",costo:0,precio:0,ubicacion:"",tipo:"Servicio"}}ngOnInit(){this.servimenu.setencabezado("Alta de servicios-ubicaci\xf3n"),this.valorubicacion(this.authService.usuario.ubicacion),this.filteredOptions=this.myControl.valueChanges.pipe((0,T.O)(""),(0,v.b)(200),(0,A.U)(i=>this._filter(i||"")))}formato(){this.inventario.id_inventario="I"+String(1e9+this.valorI).slice(1)}guardar(){""!==this.inventario.id_prod_serv?this.httpservi.obtenerinventarios().subscribe(i=>{this.valorI=i+1,this.formato(),this.crearinventario()}):u().fire({title:"Llene los campos",text:"Favor de llenar los campos",icon:"warning",confirmButtonText:"ok"})}crearinventario(){this.httpservi.guardarinventario(this.inventario).subscribe(i=>{console.log("agregado",i),this.modal()},i=>{u().fire({title:"Servicio repetido",html:"El servicio ya se encuentra en la ubicaci\xf3n seleccionada",icon:"warning",confirmButtonText:"ok"}),console.log(i)})}modal(){u().fire({title:"Agregado",html:`Servicio con numero de inventario  <b>${this.inventario.id_inventario}</b> dado de alta correctamente`,icon:"success",confirmButtonText:"ok"}).then(i=>{i.isConfirmed&&(this.inventario.costo=0,this.inventario.precio=0,this.servi="",this.myControl.patchValue(""))})}_filter(i){return this.filterValue=i.toLowerCase(),console.log(this.filterValue),this.filterValue?(this.servicios(),this.options.filter(o=>o.toLowerCase().includes(this.filterValue))):this.options.filter(o=>o.toLowerCase().includes(this.filterValue))}servicios(){this.httpservi.obtenerservicio(this.filterValue,"Servicio").subscribe(i=>{this.options=[];for(const o in i)this.options.push(i[o].descripcion)})}idservicio(){this.servi=this.myControl.value,this.httpservi.obtenerservicio(this.servi,"Servicio").subscribe(i=>{console.log(i[0].id_prod_serv),this.inventario.id_prod_serv=i[0].id_prod_serv,this.guardar()})}valorubicacion(i){this.httpservi.obtenerubicacion(i).subscribe(a=>{for(const r in a)this.inventario.ubicacion=a[r].id_ubicacion})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(b),t.Y36(q.e),t.Y36(y.h))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-alta"]],decls:43,vars:8,consts:[[1,"custom"],[1,"container"],[1,"row"],["fxLayoutAlign","space-between",1,"col-sm-auto"],["appearance","fill"],["matInput","","placeholder","0","readonly","",3,"value"],["appearance","fill",1,"example-full-width",2,"width","250px"],["type","text","placeholder","","aria-label","Nombre","matInput","",3,"formControl","matAutocomplete"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-auto"],["appearance","fill",2,"width","130px"],["matInput","","placeholder","","value","",3,"ngModel","ngModelChange"],[1,"col-sm"],[1,"example-button-row"],["mat-raised-button","","color","accent",2,"margin-top","15px",3,"click"],[3,"value"]],template:function(i,o){if(1&i&&(t._UZ(0,"br"),t.TgZ(1,"mat-card",0),t.TgZ(2,"h3"),t._uU(3,"Ingrese los datos"),t.qZA(),t.TgZ(4,"mat-card-content"),t.TgZ(5,"div",1),t.TgZ(6,"div",2),t.TgZ(7,"div",3),t.TgZ(8,"mat-form-field",4),t.TgZ(9,"mat-label"),t._uU(10,"Tu ubicaci\xf3n "),t.TgZ(11,"mat-icon"),t._uU(12,"locked"),t.qZA(),t.qZA(),t._UZ(13,"input",5),t.qZA(),t.qZA(),t.TgZ(14,"div",3),t.TgZ(15,"mat-form-field",6),t.TgZ(16,"mat-label"),t._uU(17,"Nombre del servicio"),t.qZA(),t._UZ(18,"input",7),t.TgZ(19,"mat-autocomplete",null,8),t.YNc(21,O,2,2,"mat-option",9),t.ALo(22,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"div",10),t.TgZ(24,"mat-form-field",11),t.TgZ(25,"mat-label"),t._uU(26,"Costo "),t.TgZ(27,"mat-icon"),t._uU(28,"create"),t.qZA(),t.qZA(),t.TgZ(29,"input",12),t.NdJ("ngModelChange",function(r){return o.inventario.costo=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(30,"div",10),t.TgZ(31,"mat-form-field",11),t.TgZ(32,"mat-label"),t._uU(33,"Precio "),t.TgZ(34,"mat-icon"),t._uU(35,"create"),t.qZA(),t.qZA(),t.TgZ(36,"input",12),t.NdJ("ngModelChange",function(r){return o.inventario.precio=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(37,"div",13),t.TgZ(38,"div",14),t.TgZ(39,"button",15),t.NdJ("click",function(){return o.idservicio()}),t._uU(40,"Guardar"),t.TgZ(41,"mat-icon"),t._uU(42,"check"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&i){const a=t.MAs(20);t.xp6(13),t.Q6J("value",o.authService.usuario.ubicacion),t.xp6(5),t.Q6J("formControl",o.myControl)("matAutocomplete",a),t.xp6(3),t.Q6J("ngForOf",t.lcZ(22,6,o.filteredOptions)),t.xp6(8),t.Q6J("ngModel",o.inventario.costo),t.xp6(7),t.Q6J("ngModel",o.inventario.precio)}},directives:[_.a8,_.dn,w.Wh,g.KE,g.hX,U.Hw,N.Nt,l.Fj,C.ZL,l.JJ,l.oH,C.XC,d.sg,l.On,S.lW,J.ey],pipes:[d.Ov],styles:[""]}),e})();var c=s(2789),B=s(9692);function z(e,n){if(1&e&&(t.TgZ(0,"mat-option",10),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.Q6J("value",i),t.xp6(1),t.hij(" ",i," ")}}let D=(()=>{class e{constructor(i,o){this.httpservi=i,this.authService=o,this.filter="",this.myControl=new l.NI(""),this.options=[],this.servi="",this.filterValue="",this.id_ubicacion="",this.messageEvent=new t.vpe}ngOnInit(){this.ubicacionusuario(this.authService.usuario.ubicacion),this.filteredOptions=this.myControl.valueChanges.pipe((0,T.O)(""),(0,v.b)(100),(0,A.U)(i=>this._filter(i||"")))}_filter(i){return this.filterValue=i.toLowerCase(),this.filterValue?(this.inventarios(),this.options.filter(o=>o.toLowerCase().includes(this.filterValue))):this.options.filter(o=>o.toLowerCase().includes(this.filterValue))}inventarios(){this.httpservi.obtenerinventario(this.id_ubicacion,this.filterValue,"Servicio","").subscribe(i=>{this.options=[];for(const o in i)this.options.push(i[o].productos_servicios.descripcion),this.options.push(i[o].productos_servicios.codigo_barra),console.log(this.options)})}ubicacionusuario(i){this.httpservi.obtenerubicacion(i).subscribe(a=>{for(const r in a)this.id_ubicacion=a[r].id_ubicacion;this.servi="",this.options=[]})}inventarioseleccionado(){this.servi=this.myControl.value,this.options=[],this.messageEvent.emit(this.servi),this.myControl.patchValue("")}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(b),t.Y36(q.e))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-buscador"]],outputs:{messageEvent:"messageEvent"},decls:20,vars:5,consts:[[1,"custom"],[1,"row"],["fxLayoutAlign","space-between",1,"col-sm-auto"],["appearance","fill",1,"example-full-width",2,"width","250px"],["type","text","placeholder","","aria-label","Nombre","matInput","",3,"formControl","matAutocomplete"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm"],[1,"example-button-row",2,"margin-right","1px"],["mat-raised-button","","color","accent",2,"margin-top","15px",3,"click"],[3,"value"]],template:function(i,o){if(1&i&&(t._UZ(0,"br"),t.TgZ(1,"mat-card",0),t.TgZ(2,"mat-card-content"),t.TgZ(3,"div",1),t.TgZ(4,"div",2),t.TgZ(5,"mat-form-field",3),t.TgZ(6,"mat-label"),t._uU(7,"Nombre del servicio"),t.qZA(),t._UZ(8,"input",4),t.TgZ(9,"mat-autocomplete",null,5),t.YNc(11,z,2,2,"mat-option",6),t.ALo(12,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",7),t.TgZ(14,"div",8),t.TgZ(15,"button",9),t.NdJ("click",function(){return o.inventarioseleccionado()}),t._uU(16,"Buscar "),t.TgZ(17,"mat-icon"),t._uU(18,"search"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t._UZ(19,"br")),2&i){const a=t.MAs(10);t.xp6(8),t.Q6J("formControl",o.myControl)("matAutocomplete",a),t.xp6(3),t.Q6J("ngForOf",t.lcZ(12,3,o.filteredOptions))}},directives:[_.a8,_.dn,w.Wh,g.KE,g.hX,N.Nt,l.Fj,C.ZL,l.JJ,l.oH,C.XC,d.sg,S.lW,U.Hw,J.ey],pipes:[d.Ov],styles:[""]}),e})();function Q(e,n){1&e&&(t.TgZ(0,"th",20),t._uU(1," # "),t.qZA())}function F(e,n){if(1&e&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&e){const i=n.index;t.xp6(1),t.hij(" ",i+1," ")}}function L(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1," N\xfamero de servicio"),t.qZA())}function k(e,n){if(1&e&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.id_inventario," ")}}function P(e,n){1&e&&(t.TgZ(0,"th",23),t._uU(1," Descripci\xf3n"),t.qZA())}function R(e,n){if(1&e&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,i.productos_servicios.descripcion)," ")}}function V(e,n){1&e&&(t.TgZ(0,"th",20),t._uU(1," Costo"),t.qZA())}function H(e,n){if(1&e&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.costo," ")}}function $(e,n){1&e&&(t.TgZ(0,"th",20),t._uU(1," Precio"),t.qZA())}function W(e,n){if(1&e&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.precio," ")}}function G(e,n){1&e&&(t.TgZ(0,"th",24),t._uU(1," Ubicaci\xf3n"),t.qZA())}function X(e,n){if(1&e&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,i.ubicacion.descripcion)," ")}}function K(e,n){1&e&&t._UZ(0,"th",25)}function tt(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"td",21),t.TgZ(1,"a",26),t.NdJ("click",function(){const r=t.CHM(i).$implicit;return t.oxw().eliminar(r._id,r.productos_servicios.descripcion)}),t.TgZ(2,"mat-icon",27),t._uU(3,"delete"),t.qZA(),t.qZA(),t.qZA()}}function it(e,n){1&e&&t._UZ(0,"tr",28)}function et(e,n){1&e&&t._UZ(0,"tr",29)}const ot=function(){return[5,10,20]};let nt=(()=>{class e{constructor(i,o,a){this.httpservi=i,this.authService=o,this.servimenu=a,this.servi="",this.serviciostabla=[],this.id_ubicacion="",this.displayedColumns=["index","id_inventario","productos_servicios.descripcion","costo","precio","ubicacion.descripcion","borrar"],this.dataSource=new c.by}ngOnInit(){this.servimenu.setencabezado("Baja de servicios-ubicaci\xf3n"),this.ubicacionusuario(this.authService.usuario.ubicacion)}inventarioseleccionado(i){this.servi=i,""!==this.servi&&this.httpservi.obtenerinventario(this.id_ubicacion,this.servi,"Servicio","").subscribe(o=>{this.serviciostabla=[],this.serviciostabla=o,this.dataSource=new c.by(this.serviciostabla),this.dataSource.paginator=this.paginator,this.dataSource.paginator._intl.itemsPerPageLabel="Filas por pagina",this.servi=""})}ubicacionusuario(i){this.httpservi.obtenerubicacion(i).subscribe(a=>{for(const r in a)this.id_ubicacion=a[r].id_ubicacion;this.servi=""})}eliminar(i,o){u().fire({title:"\xbfEstas seguro?",html:`Estas por dar de baja el Servicio <b>${o}</b>`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, dar de baja!"}).then(a=>{a.isConfirmed&&this.httpservi.eliminarinventario(i).subscribe(r=>{console.log("eliminado",r),u().fire("Proceso correcto!","El servicio fue dado de baja correctamente.","success").then(E=>{E.isConfirmed&&(this.serviciostabla=[],this.dataSource=new c.by)})})})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(b),t.Y36(q.e),t.Y36(y.h))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-baja"]],viewQuery:function(i,o){if(1&i&&t.Gf(B.NW,5),2&i){let a;t.iGM(a=t.CRH())&&(o.paginator=a.first)}},decls:31,vars:5,consts:[[3,"messageEvent"],[1,"row"],[1,"container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","","width","10%",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id_inventario"],["mat-header-cell","","width","25%",4,"matHeaderCellDef"],["matColumnDef","productos_servicios.descripcion"],["mat-header-cell","","width","22%",4,"matHeaderCellDef"],["matColumnDef","costo"],["matColumnDef","precio"],["matColumnDef","ubicacion.descripcion"],["mat-header-cell","","width","20%",4,"matHeaderCellDef"],["matColumnDef","borrar"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","label","seleccione",3,"pageSizeOptions"],["mat-header-cell","","width","10%"],["mat-cell",""],["mat-header-cell","","width","25%"],["mat-header-cell","","width","22%"],["mat-header-cell","","width","20%"],["mat-header-cell",""],["type","button",3,"click"],["color","warn",1,"icon"],["mat-header-row",""],["mat-row",""]],template:function(i,o){1&i&&(t.TgZ(0,"app-buscador",0),t.NdJ("messageEvent",function(r){return o.inventarioseleccionado(r)}),t.qZA(),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"mat-card"),t.TgZ(4,"h3"),t._uU(5,"Detalles"),t.qZA(),t.TgZ(6,"table",3),t.ynx(7,4),t.YNc(8,Q,2,0,"th",5),t.YNc(9,F,2,1,"td",6),t.BQk(),t.ynx(10,7),t.YNc(11,L,2,0,"th",8),t.YNc(12,k,2,1,"td",6),t.BQk(),t.ynx(13,9),t.YNc(14,P,2,0,"th",10),t.YNc(15,R,3,3,"td",6),t.BQk(),t.ynx(16,11),t.YNc(17,V,2,0,"th",5),t.YNc(18,H,2,1,"td",6),t.BQk(),t.ynx(19,12),t.YNc(20,$,2,0,"th",5),t.YNc(21,W,2,1,"td",6),t.BQk(),t.ynx(22,13),t.YNc(23,G,2,0,"th",14),t.YNc(24,X,3,3,"td",6),t.BQk(),t.ynx(25,15),t.YNc(26,K,1,0,"th",16),t.YNc(27,tt,4,0,"td",6),t.BQk(),t.YNc(28,it,1,0,"tr",17),t.YNc(29,et,1,0,"tr",18),t.qZA(),t._UZ(30,"mat-paginator",19),t.qZA(),t.qZA(),t.qZA()),2&i&&(t.xp6(6),t.Q6J("dataSource",o.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(4,ot)))},directives:[D,_.a8,c.BZ,c.w1,c.fO,c.Dz,c.as,c.nj,B.NW,c.ge,c.ev,U.Hw,c.XQ,c.Gk],pipes:[d.rS],styles:["table[_ngcontent-%COMP%]{width:100%;display:block;overflow-x:auto}"]}),e})();function at(e,n){if(1&e&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.Q6J("value",i),t.xp6(1),t.hij(" ",i," ")}}function rt(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1," # "),t.qZA())}function st(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const i=n.index;t.xp6(1),t.hij(" ",i+1," ")}}function ct(e,n){1&e&&(t.TgZ(0,"th",29),t._uU(1," N\xfamero de servicio"),t.qZA())}function lt(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.id_inventario," ")}}function ut(e,n){1&e&&(t.TgZ(0,"th",30),t._uU(1," Descripci\xf3n"),t.qZA())}function pt(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,i.productos_servicios.descripcion)," ")}}function dt(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1," Costo"),t.qZA())}function mt(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.costo," ")}}function ht(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1," Precio"),t.qZA())}function vt(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",i.precio," ")}}function _t(e,n){1&e&&(t.TgZ(0,"th",31),t._uU(1," Ubicaci\xf3n"),t.qZA())}function gt(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const i=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,i.ubicacion.descripcion)," ")}}function ft(e,n){1&e&&t._UZ(0,"tr",32)}function Zt(e,n){1&e&&t._UZ(0,"tr",33)}const Ct=function(){return[5,10,20]};let Tt=(()=>{class e{constructor(i,o,a){this.httpservi=i,this.authService=o,this.servimenu=a,this.filter="",this.myControl=new l.NI(""),this.options=[],this.servi="",this.filterValue="",this.serviciostabla=[],this.id_ubicacion="",this.displayedColumns=["index","id_inventario","productos_servicios.descripcion","costo","precio","ubicacion.descripcion"],this.dataSource=new c.by}ngOnInit(){this.servimenu.setencabezado("Consulta de servicios"),this.ubicacionusuario(this.authService.usuario.ubicacion),this.filteredOptions=this.myControl.valueChanges.pipe((0,T.O)(""),(0,v.b)(100),(0,A.U)(i=>this._filter(i||"")))}_filter(i){return this.filterValue=i.toLowerCase(),this.filterValue?(this.inventarios(),this.options.filter(o=>o.toLowerCase().includes(this.filterValue))):this.options.filter(o=>o.toLowerCase().includes(this.filterValue))}inventarios(){this.httpservi.obtenerinventario(this.id_ubicacion,this.filterValue,"Servicio","consulta").subscribe(i=>{this.options=[];for(const o in i)this.options.push(i[o].productos_servicios.descripcion),this.options.push(i[o].productos_servicios.codigo_barra),this.options=[...new Set(this.options)],console.log(this.options)})}inventarioseleccionado(){this.options=[],this.servi=this.myControl.value,""!==this.servi&&this.httpservi.obtenerinventario(this.id_ubicacion,this.servi,"Servicio","consulta").subscribe(i=>{this.serviciostabla=[],this.serviciostabla=i,this.dataSource=new c.by(this.serviciostabla),this.dataSource.paginator=this.paginator,this.dataSource.paginator._intl.itemsPerPageLabel="Filas por pagina",this.servi="",this.myControl.patchValue("")})}ubicacionusuario(i){this.httpservi.obtenerubicacion(i).subscribe(a=>{for(const r in a)this.id_ubicacion=a[r].id_ubicacion;this.servi="",this.options=[]})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(b),t.Y36(q.e),t.Y36(y.h))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-consulta"]],viewQuery:function(i,o){if(1&i&&t.Gf(B.NW,5),2&i){let a;t.iGM(a=t.CRH())&&(o.paginator=a.first)}},decls:47,vars:10,consts:[[1,"custom"],[1,"row"],["fxLayoutAlign","space-between",1,"col-sm-auto"],["appearance","fill",1,"example-full-width",2,"width","250px"],["type","text","placeholder","","aria-label","Nombre","matInput","",3,"formControl","matAutocomplete"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm"],[1,"example-button-row",2,"margin-right","1px"],["mat-raised-button","","color","accent",2,"margin-top","15px",3,"click"],[1,"container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","index"],["mat-header-cell","","width","10%",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id_inventario"],["mat-header-cell","","width","25%",4,"matHeaderCellDef"],["matColumnDef","productos_servicios.descripcion"],["mat-header-cell","","width","30%",4,"matHeaderCellDef"],["matColumnDef","costo"],["matColumnDef","precio"],["matColumnDef","ubicacion.descripcion"],["mat-header-cell","","width","22%",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","label","seleccione",3,"pageSizeOptions"],[3,"value"],["mat-header-cell","","width","10%"],["mat-cell",""],["mat-header-cell","","width","25%"],["mat-header-cell","","width","30%"],["mat-header-cell","","width","22%"],["mat-header-row",""],["mat-row",""]],template:function(i,o){if(1&i&&(t._UZ(0,"br"),t.TgZ(1,"mat-card",0),t.TgZ(2,"mat-card-content"),t.TgZ(3,"div",1),t.TgZ(4,"div",2),t.TgZ(5,"mat-form-field",3),t.TgZ(6,"mat-label"),t._uU(7,"Nombre del servicio"),t.qZA(),t._UZ(8,"input",4),t.TgZ(9,"mat-autocomplete",null,5),t.YNc(11,at,2,2,"mat-option",6),t.ALo(12,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"div",7),t.TgZ(14,"div",8),t.TgZ(15,"button",9),t.NdJ("click",function(){return o.inventarioseleccionado()}),t._uU(16,"Buscar "),t.TgZ(17,"mat-icon"),t._uU(18,"search"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t._UZ(19,"br"),t.TgZ(20,"div",1),t.TgZ(21,"div",10),t.TgZ(22,"mat-card"),t.TgZ(23,"h3"),t._uU(24,"Detalles"),t.qZA(),t.TgZ(25,"table",11),t.ynx(26,12),t.YNc(27,rt,2,0,"th",13),t.YNc(28,st,2,1,"td",14),t.BQk(),t.ynx(29,15),t.YNc(30,ct,2,0,"th",16),t.YNc(31,lt,2,1,"td",14),t.BQk(),t.ynx(32,17),t.YNc(33,ut,2,0,"th",18),t.YNc(34,pt,3,3,"td",14),t.BQk(),t.ynx(35,19),t.YNc(36,dt,2,0,"th",13),t.YNc(37,mt,2,1,"td",14),t.BQk(),t.ynx(38,20),t.YNc(39,ht,2,0,"th",13),t.YNc(40,vt,2,1,"td",14),t.BQk(),t.ynx(41,21),t.YNc(42,_t,2,0,"th",22),t.YNc(43,gt,3,3,"td",14),t.BQk(),t.YNc(44,ft,1,0,"tr",23),t.YNc(45,Zt,1,0,"tr",24),t.qZA(),t._UZ(46,"mat-paginator",25),t.qZA(),t.qZA(),t.qZA()),2&i){const a=t.MAs(10);t.xp6(8),t.Q6J("formControl",o.myControl)("matAutocomplete",a),t.xp6(3),t.Q6J("ngForOf",t.lcZ(12,7,o.filteredOptions)),t.xp6(14),t.Q6J("dataSource",o.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(9,Ct))}},directives:[_.a8,_.dn,w.Wh,g.KE,g.hX,N.Nt,l.Fj,C.ZL,l.JJ,l.oH,C.XC,d.sg,S.lW,U.Hw,c.BZ,c.w1,c.fO,c.Dz,c.as,c.nj,B.NW,J.ey,c.ge,c.ev,c.XQ,c.Gk],pipes:[d.Ov,d.rS],styles:["table[_ngcontent-%COMP%]{width:100%;display:block;overflow-x:auto}"]}),e})();const bt=[{path:"",children:[{path:"alta",component:Y,data:{Transaccion:"SERVICIOS-UBICACION-ALTA"},canActivate:[h.z,m._],canLoad:[h.z,m._]},{path:"ajuste",component:(()=>{class e{constructor(i,o,a){this.httpservi=i,this.authService=o,this.servimenu=a,this.servi="",this.estado=!0,this.descripcion="",this.servicio="",this.razon_precio="",this.razon_costo="",this.precio=0,this.costo=0,this.nuevo_precio=0,this.nuevo_costo=0,this.inventario={_id:"",id_inventario:"",id_prod_serv:"",costo:0,precio:0,ubicacion:"",tipo:"Servicio"},this.auditoria={id_inventario:"",fecha:new Date,id_usuario:this.authService.usuario._id,usuario:this.authService.usuario.nombre,razon:"",tipo_ajuste:"",valor_anterior:0,nuevo_valor:0}}ngOnInit(){this.servimenu.setencabezado("Ajuste de precios"),this.ubicacionusuario(this.authService.usuario.ubicacion)}inventarioseleccionado(i){this.servi=i,""!==this.servi&&this.httpservi.obtenerinventario(this.inventario.ubicacion,this.servi,"Servicio","").subscribe(o=>{console.log(o);for(const a in o)this.inventario._id=o[a]._id,this.servicio=o[a].productos_servicios.descripcion,this.inventario.id_prod_serv=o[a].id_prod_serv,this.inventario.id_inventario=o[a].id_inventario,this.costo=o[a].costo,this.precio=o[a].precio,this.descripcion=o[a].ubicacion.descripcion,this.auditoria.id_inventario=o[a].id_inventario})}actualizar(){""!==this.auditoria.razon?this.httpservi.actualizarinventario(this.inventario).subscribe(i=>{console.log("actualizado",i),this.modal(),this.httpservi.guardarauditoria(this.auditoria).subscribe(o=>{console.log("auditoria guardada",o)},o=>{u().fire({title:"Ups!!",text:"No se pudo guardar la auditoria",icon:"success",confirmButtonText:"ok"}),console.log(o)})},i=>{u().fire({title:"Ups!!",text:"No se pudieron guardar los cambios",icon:"success",confirmButtonText:"ok"}),console.log(i)}):u().fire({title:"Ups!!",text:"Agregue la raz\xf3n del ajuste",icon:"warning",confirmButtonText:"ok"})}modal(){u().fire({title:"Cambios aplicados",text:"Se han guardado y aplicado los cambios correctamente",icon:"success",confirmButtonText:"ok"}).then(i=>{i.isConfirmed&&(this.razon_precio="",this.razon_costo="",this.nuevo_precio=0,this.nuevo_costo=0,this.inventarioseleccionado(this.servi))})}ubicacionusuario(i){this.httpservi.obtenerubicacion(i).subscribe(a=>{for(const r in a)this.inventario.ubicacion=a[r].id_ubicacion;this.servi=""})}ajusteprecio(){this.inventario.precio=this.nuevo_precio,this.inventario.costo=this.costo,this.auditoria.tipo_ajuste="Precio de Servicios",this.auditoria.valor_anterior=this.precio,this.auditoria.nuevo_valor=this.inventario.precio,this.auditoria.razon=this.razon_precio,0!==this.nuevo_precio?this.actualizar():u().fire({title:"Ups!!",text:"Agregue el precio del ajuste",icon:"warning",confirmButtonText:"ok"})}ajustecosto(){this.inventario.precio=this.precio,this.inventario.costo=this.nuevo_costo,this.auditoria.tipo_ajuste="Costo de Servicios",this.auditoria.valor_anterior=this.costo,this.auditoria.nuevo_valor=this.inventario.costo,this.auditoria.razon=this.razon_costo,0!==this.nuevo_costo?this.actualizar():u().fire({title:"Ups!!",text:"Agregue el costo del ajuste",icon:"warning",confirmButtonText:"ok"})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(b),t.Y36(q.e),t.Y36(y.h))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-editar"]],decls:81,vars:9,consts:[[3,"messageEvent"],[1,"row"],[1,"example-container"],["fxLayoutAlign","space-between",1,"col-sm-auto"],["appearance","fill"],["matInput","","placeholder","0","readonly","",3,"value"],["matInput","","placeholder","","value","","readonly","",3,"ngModel","ngModelChange"],["appearance","fill",2,"width","250px"],["matInput","","placeholder","producto","value","","readonly","",3,"ngModel","ngModelChange"],["appearance","fill",2,"width","150px"],["matInput","","placeholder","0","value","","readonly","",3,"ngModel","ngModelChange"],["matInput","","type","number","placeholder","","value","",3,"ngModel","ngModelChange"],["appearance","fill",2,"width","300px"],["matInput","",3,"ngModel","ngModelChange"],[1,"col-sm"],[1,"example-button-row",2,"margin-right","1px"],["mat-raised-button","","color","warn",2,"margin-top","30px",3,"click"],[1,"col-sm-auto"],["mat-raised-button","","color","primary",2,"margin-top","30px",3,"click"]],template:function(i,o){1&i&&(t.TgZ(0,"app-buscador",0),t.NdJ("messageEvent",function(r){return o.inventarioseleccionado(r)}),t.qZA(),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"mat-card"),t.TgZ(4,"h3"),t._uU(5,"Detalles del servicio"),t.qZA(),t.TgZ(6,"mat-card-content"),t.TgZ(7,"div",1),t.TgZ(8,"div",3),t.TgZ(9,"mat-form-field",4),t.TgZ(10,"mat-label"),t._uU(11,"Ubicaci\xf3n"),t.TgZ(12,"mat-icon"),t._uU(13,"locked"),t.qZA(),t.qZA(),t._UZ(14,"input",5),t.qZA(),t.qZA(),t.TgZ(15,"div",3),t.TgZ(16,"mat-form-field",4),t.TgZ(17,"mat-label"),t._uU(18,"N\xfamero de inventario "),t.TgZ(19,"mat-icon"),t._uU(20,"locked"),t.qZA(),t.qZA(),t.TgZ(21,"input",6),t.NdJ("ngModelChange",function(r){return o.inventario.id_inventario=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(22,"div",3),t.TgZ(23,"mat-form-field",7),t.TgZ(24,"mat-label"),t._uU(25,"Descripci\xf3n del servicio "),t.TgZ(26,"mat-icon"),t._uU(27,"locked"),t.qZA(),t.qZA(),t.TgZ(28,"input",8),t.NdJ("ngModelChange",function(r){return o.servicio=r}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(29,"mat-card-content"),t.TgZ(30,"div",1),t.TgZ(31,"div",3),t.TgZ(32,"mat-form-field",9),t.TgZ(33,"mat-label"),t._uU(34,"Precio actual"),t.TgZ(35,"mat-icon"),t._uU(36,"locked"),t.qZA(),t.qZA(),t.TgZ(37,"input",10),t.NdJ("ngModelChange",function(r){return o.precio=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(38,"div",3),t.TgZ(39,"mat-form-field",4),t.TgZ(40,"mat-label"),t._uU(41,"Nueva precio "),t.TgZ(42,"mat-icon"),t._uU(43,"create"),t.qZA(),t.qZA(),t.TgZ(44,"input",11),t.NdJ("ngModelChange",function(r){return o.nuevo_precio=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(45,"div",3),t.TgZ(46,"mat-form-field",12),t.TgZ(47,"mat-label"),t._uU(48,"Raz\xf3n del ajuste"),t.qZA(),t.TgZ(49,"textarea",13),t.NdJ("ngModelChange",function(r){return o.razon_precio=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(50,"div",14),t.TgZ(51,"div",15),t.TgZ(52,"button",16),t.NdJ("click",function(){return o.ajusteprecio()}),t._uU(53,"Guardar precio"),t.TgZ(54,"mat-icon"),t._uU(55,"build"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(56,"div",1),t.TgZ(57,"div",3),t.TgZ(58,"mat-form-field",9),t.TgZ(59,"mat-label"),t._uU(60,"Costo actual"),t.TgZ(61,"mat-icon"),t._uU(62,"locked"),t.qZA(),t.qZA(),t.TgZ(63,"input",10),t.NdJ("ngModelChange",function(r){return o.costo=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(64,"div",3),t.TgZ(65,"mat-form-field",4),t.TgZ(66,"mat-label"),t._uU(67,"Nuevo costo "),t.TgZ(68,"mat-icon"),t._uU(69,"create"),t.qZA(),t.qZA(),t.TgZ(70,"input",11),t.NdJ("ngModelChange",function(r){return o.nuevo_costo=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(71,"div",17),t.TgZ(72,"mat-form-field",12),t.TgZ(73,"mat-label"),t._uU(74,"Raz\xf3n del ajuste"),t.qZA(),t.TgZ(75,"textarea",13),t.NdJ("ngModelChange",function(r){return o.razon_costo=r}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(76,"div",14),t.TgZ(77,"button",18),t.NdJ("click",function(){return o.ajustecosto()}),t._uU(78,"Guardar costo"),t.TgZ(79,"mat-icon"),t._uU(80,"build"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&i&&(t.xp6(14),t.Q6J("value",o.descripcion),t.xp6(7),t.Q6J("ngModel",o.inventario.id_inventario),t.xp6(7),t.Q6J("ngModel",o.servicio),t.xp6(9),t.Q6J("ngModel",o.precio),t.xp6(7),t.Q6J("ngModel",o.nuevo_precio),t.xp6(5),t.Q6J("ngModel",o.razon_precio),t.xp6(14),t.Q6J("ngModel",o.costo),t.xp6(7),t.Q6J("ngModel",o.nuevo_costo),t.xp6(5),t.Q6J("ngModel",o.razon_costo))},directives:[D,_.a8,_.dn,w.Wh,g.KE,g.hX,U.Hw,N.Nt,l.Fj,l.JJ,l.On,l.wV,S.lW],styles:[""]}),e})(),data:{Transaccion:"SERVICIOS-UBICACION-AJUSTE"},canActivate:[h.z,m._],canLoad:[h.z,m._]},{path:"baja",component:nt,data:{Transaccion:"SERVICIOS-UBICACION-BAJA"},canActivate:[h.z,m._],canLoad:[h.z,m._]},{path:"consulta",component:Tt,data:{Transaccion:"SERVICIOS-UBICACION-CONSULTA"},canActivate:[h.z,m._],canLoad:[h.z,m._]},{path:"**",redirectTo:"/menu/md"}]}];let qt=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[Z.Bz.forChild(bt)],Z.Bz]}),e})(),Ut=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[d.ez,qt,M.q,l.UX,l.u5]]}),e})()}}]);